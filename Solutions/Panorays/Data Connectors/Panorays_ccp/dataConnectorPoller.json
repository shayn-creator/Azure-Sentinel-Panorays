[
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2025-10-30-preview",
    "name": "Panorays_Company_Findings",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "ccpPanoraysCompanyFindingPOC",
      "dataType": "PanoraysCompanyFindingPOC_CL",
      "dcrConfig": {
        "streamName": "Custom-PanoraysCompanyFindings_API",
        "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
        "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
      },
      "auth": {
        "type": "APIKey",
        "ApiKey": "[[parameters('apitoken')]",
        "ApiKeyName": "Authorization",
        "ApiKeyIdentifier": "ApiToken"
      },
      "request": {
        "apiEndpoint": "[[concat(parameters('https://api.panoraysapp.com'), '/v2/findings/']",
        "rateLimitQPS": 10,
        "queryWindowInMin": 5,
        "httpMethod": "GET",
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json",
          "User-Agent": "PanoraysIntegration/1.0 (shay.n@panorays.com)"
        }
      },
      "paging": {
        "pagingType": "NextPageToken",
        "PageSize": "1000",
        "PageSizeParameterName": "limit",
        "NextPageTokenJsonPath": "$.pagination.nextCursor",
        "NextPageParaName": "cursor"
      },
      "response": {
        "eventsJsonPaths": [
          "$.data"
        ]
      }
    }
  }
]